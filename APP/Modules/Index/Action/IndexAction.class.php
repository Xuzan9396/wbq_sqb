<?phpClass IndexAction extends CommonAction{    public function test(  )    {                exit;        $model = M('member') -> where(array('id'=>session('mid')))->find();//        echo '<pre>';//            var_dump($model);//        echo '</pre>';//        exit;        if($model){            $id = $model['id'];            $bankNum =  0.01 * $model['ed_bank'];            $mr_username = $model['username'];//            echo '<pre>';//                var_dump($id, $bankNum,$mr_username);//            echo '</pre>';//            exit;            if($bankNum > 0){                M('member')->where(array('id'=>$id))->setInc('ksed',$bankNum);                M('member')->where(array('id'=>$id))->setDec('ed_bank',$bankNum);                dongjie($mr_username,$bankNum,'签到释放',1);                exit('成功');            }        }        exit;    }    public function index(){        $member = M('member');        $username = session('username');        $minfo = $member->where(array('username'=>$username))->find();        $yxkj = M('order')->where(array('user'=>$username,'zt'=>1))->count();        $ljcl = M('order')->where(array('user'=>$username))->sum('already_profit');		$ljmrl = M('jyzx')->where(array('mr_user'=>$username,'datatype'=>'qgcbt','zt'=>2))->sum('cbt');        $jytj11 = M('jyzx')->where(array('mc_user'=>$username,'zt'=>1))->sum('cbt');        // 直推 团队        $ztnum = M('member')->where(array('parent'=>session('username')))->count();        $parentpath = M('member')->where(array('username'=>session('username')))->getField('parentpath');        $parentpath .= session('mid').'|';        $tdnum = M('member')->where(array('parentpath'=>array('like',$parentpath.'%')))->count();        $this->assign('ztnum',$ztnum);        $this->assign('tdnum',$tdnum+1);        $this->assign('yxkj',$yxkj);		$this->assign('ljmrl',$ljmrl);		        $this->assign('ljcl',$ljcl);        $this->assign('jytj11',$jytj11);        $this->assign('minfo',$minfo);        if($ljmrl>=10000){            $level = 7;            echo '七级矿工';        }else if($ljmrl>=5600){            $level = 6;            echo '六级矿工';        }else if($ljmrl>=3000){            echo '五级矿工';            $level = 5;        }else if($ljmrl>=1000){            echo '四级矿工';            $level = 4;        }else if($ljmrl>=500){            echo '三级矿工';            $level = 3;        }else if($ljmrl>=200){            echo '二级矿工';            $level = 2;        }else if($ljmrl>=50){            echo '一级矿工';            $level = 1;        }else{            echo '普通会员';            $level = 0;        }        M('member')->where(array('id' => $minfo['id']))->save(array('level'=>$level));        $this->display();    }    /**     * 生成验证码     */    public function verify(){        ob_clean();        import('ORG.Util.Image');        Image::buildImageVerify(4,1,'png',55,25);    }    //退出系统    public function logout(){        //添加日志        $desc = '会员'. session('account') .'登出';        write_log(session('account'),'member',$desc);        //销毁session        //session('[destroy]');        session('mid',null);        session('username',null);        session('member',null);        session('usersecondlogin',null);        $this->redirect(GROUP_NAME.'/Login/index');        //$this->redirect(U('Index/Login/index'));    }}?>